
<html><head><title>Statistical significance calculator (JavaScript chi-squared test)</title>
<style type="text/css">
html { font-family: "Lucida Grande"; font-size: 10pt;}
</style>
</head>
<body onclick="doit()">
<div style="width: 33%; float: right; margin-left: 1em; background-color: #eee; padding: 1em; margin-top: 1em; margin-right: 0"><h2 style="margin-top: 0">How do I use this?</h2>
  <p>Imagine you want to test two subject lines on emails:</p>
<ol style="list-style-type: upper-alpha">
<li>Save the whales, bro</li>
<li>SAVE THE WHALES!!!</li>
</ol>
<p>and you send them both to 1000 people. 1000 should go in the <strong>Sample</strong> column in both rows.</p>

<p>Then let's say A gets opened by 220 people and B gets opened by 194. Those numbers go in the <strong>Affected</strong> column. (<a href="http://stats.theinfo.org/?n1=1000&amp;n2=1000&amp;x1=220&amp;x2=194">See?</a>)</p>

<p><small>You can also click <strong>Affected</strong> and change it to <strong>Opened</strong>, if that makes it clearer for you. (<a href="http://stats.theinfo.org/?n1=1000&amp;n2=1000&amp;x1=220&amp;x2=194&amp;a=Opened">See?</a>)</small></p>

<iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fstats.theinfo.org%2F&amp;layout=box_count&amp;show_faces=false&amp;width=450&amp;action=like&amp;colorscheme=light&amp;height=65" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:65px;" allowTransparency="true"></iframe>
</div>
<h1>Statistical significance calculator</h1>

<p>This tool calculates statistical significance for little experiments.</p>

<table onkeyup="doit()" onchange="doit()" onblur="doit()"> 
<tr><td></td><th>Sample</th><th><input type="text" value="Affected"  style="text-align: center; font-weight: bold; border: 1px solid #ccc" id="a" /></th></tr> 
<tr><th>Group A</th><td><input type="text" id="n1" /></td><td><input type="text" id="x1" /></td></tr> 
<tr><th>Group B</th><td><input type="text" id="n2" /></td><td><input type="text" id="x2" /></td></tr>
</table>
<div style="float: right; margin-top: -1.5em" id="linkbox" style="display: none"><a href="" id="link">Link</a></div>


<div id="output" onclick="doit()" style="height: 5.75em"></div>

<p><em>Just so you know...</em><br />
<strong style='color: #a00'>89%</strong> or less could just be a fluke<br />
<strong style='color: #aa0'>90%</strong> is pretty good for a rough sense<br />
<strong style='color: #0a0'>95%</strong> is good enough for academic publishing<br />
<strong style='color: #0d0'>99%</strong> or higher is <em>awesome</em>
</p>

<p><small>...but this is all assuming you set up the experiment correctly.</small></p>

<!--TODO:
 - how big a sample should I use? calculator

-->
<address style="position: absolute; bottom: 0; padding-bottom: 1em">created by <a href="http://www.aaronsw.com/">Aaron Swartz</a> (<a href="mailto:me@aaronsw.com">me@aaronsw.com</a>) with help from <a href="https://twitter.com/benwikler">Ben Wikler</a></address>
</body>

<script type="text/javascript" src="chi2.js"></script>
<script type="text/javascript">

/* want to validate that this works? here's the R code to compare against:

> data <- matrix(c(11,32,206-11,1374-32), nrow=2)
> chisq.test(data, correct=FALSE)

*/

function v(eid) {
  return parseInt(document.getElementById(eid).value);
}
function doit(){
  var table, result, nice_result, output, after, bigger_group;
  
  table = [[v('x1'), v('n1')-v('x1')], [v('x2'), v('n2')-v('x2')]];
  result = significance(table);
  niceresult = trimfloat(result*100, 2)
  if (niceresult == '100') { niceresult = '99.999'}
  
  if (v('x1')/v('n1') > v('x2')/v('n2')) { 
    bigger_group = 'A'; 
    improvement = v('x1')/v('n1') - v('x2')/v('n2');
  } else { 
    bigger_group = 'B'; 
    improvement = v('x2')/v('n2') - v('x1')/v('n1');
  }
  
  after = " chance that the difference isn't just due to chance.</p><p><small>In other words, while it looks like Group " + bigger_group + " did better, " + trimfloat((1-result)*100, 0) + "% of the time that will just be a coincidence.</small></p>"
  
  if (v('n1') < v('x1') || v('n2') < v('x2')) {
    output = "<strong style='color: #f00'>Oops:</strong> I think you got your <strong>Sample</strong> and your <strong>Number affected</strong> mixed up. <a href='javascript:flipit()'>Want me to flip them for you?</a>"
  } else if (isNaN(result)) {
    output = "Please enter your test data above."
  } else if ( result < .5 ) {
    output = "Dude, there's only a <strong style='color: #f00'>" + niceresult + "%</strong>" + after;
  } else if (result < .9) {
    output = "Hmm, there's only a <strong style='color: #a00'>" + niceresult + "%</strong>" + after;
  } else if ( result < .95) { 
    output = "Nice, there's a <strong style='color: #aa0'>" + niceresult + "%</strong>" + after;
  } else if ( result < .99) { 
    output = "Yay! There's a <strong style='color: #0a0'>" + niceresult + "%</strong>" + after;
  } else if ( result < 1.1) {
    output = "<em>W00t!</em> There's a <strong style='color: #0d0'>" + niceresult + "%</strong>" + after + "<p style='text-align: center'><img src='happy-cat.jpg' style='height: 4em'></p>";
  } else {
    output = result;
  }
  
  if (isNaN(result)) {
    document.getElementById('linkbox').style.display = 'none';
  } else {
    document.getElementById('linkbox').style.display = 'block';
    document.getElementById('link').href = 'http://stats.theinfo.org/?n1='+v('n1')+'&n2='+v('n2')+'&x1='+v('x1')+'&x2='+v('x2');
    if (document.getElementById('a').value != 'Affected') { 
      document.getElementById('link').href += '&a=' + document.getElementById('a').value;
    }
  }
    
  document.getElementById('output').innerHTML = '<p>' + output;
}

function flipit() {
  var n1, n2, x1, x2;
  if (v('n1') < v('x1')) {
    n1 = v('n1');
    x1 = v('x1');
    document.getElementById('n1').value = x1;
    document.getElementById('x1').value = n1;
  }
  if (v('n2') < v('x2')) {
    n2 = v('n2');
    x2 = v('x2');
    document.getElementById('n2').value = x2;
    document.getElementById('x2').value = n2;
  }
  doit()
}

function getArgs() {
    var argsStr = window.location.search;
    var pairs = argsStr.replace(/^\?/, '').split('&');
    var args = {};
    unesc = unescape;
    if ( typeof(decodeURIComponent) != 'undefined' )
        unesc = decodeURIComponent;
    for ( var i = 0; i < pairs.length; ++i ) {
        pair = pairs[i].split('=');
        if (pair[0]) {
            if (pair[1])
               pair[1] = unesc(pair[1].replace(/\+/g, ' '));
            args[unesc(pair[0].replace(/\+/g, ' '))] = pair[1];
        }
    }
    return args;
} 

function loadFromQuery() {
  args = getArgs();
  if (args.n1) document.getElementById('n1').value = args.n1;
  if (args.n2) document.getElementById('n2').value = args.n2;
  if (args.x1) document.getElementById('x1').value = args.x1;
  if (args.x2) document.getElementById('x2').value = args.x2;
  if (args.a) document.getElementById('a').value = args.a;
}
loadFromQuery();
doit();
</script>
</html>